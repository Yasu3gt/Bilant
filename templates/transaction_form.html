{% extends "base.html" %}

{% block title %}bilant | 収支登録{% endblock %}

{% block content %}
  <section class="rounded-2xl bg-white shadow-sm border p-6">
    <h1 class="text-2xl font-bold">収支登録</h1>
    <p class="mt-2 text-gray-600">収入または支出を登録します。</p>

    <form method="post" class="mt-6 grid gap-5">
      <div>
        <div class="text-sm font-medium">収支区分</div>
        <div class="mt-2 flex gap-4">
          {% for val, label in txn_types %}
            <label class="inline-flex items-center gap-2">
              <input type="radio" name="txn_type" value="{{ val }}"
                {% if (form.txn_type is defined and form.txn_type == val) or (form.txn_type is not defined and val == 'expense') %}checked{% endif %}
              />
              <span>{{ label }}</span>
            </label>
          {% endfor %}
        </div>
        {% if errors.txn_type %}
          <p class="mt-1 text-sm text-red-600">{{ errors.txn_type }}</p>
        {% endif %}
      </div>

      <div>
        <label class="text-sm font-medium" for="category">収支項目</label>
        <select id="category" name="category" class="mt-2 w-full rounded-xl border px-3 py-2 bg-white">
          <option value="">選択してください</option>
          {% for c in categories %}
            <option value="{{ c }}" {% if form.category is defined and form.category == c %}selected{% endif %}>{{ c }}</option>
          {% endfor %}
        </select>
        {% if errors.category %}
          <p class="mt-1 text-sm text-red-600">{{ errors.category }}</p>
        {% endif %}
      </div>

      <div class="grid gap-5 md:grid-cols-2">
        <div>
          <label class="text-sm font-medium" for="txn_date">年月日</label>
          <input
            id="txn_date"
            type="date"
            name="txn_date"
            value="{{ (form.txn_date if form.txn_date is defined and form.txn_date else default_date) }}"
            class="mt-2 w-full rounded-xl border px-3 py-2"
          />
          {% if errors.txn_date %}
            <p class="mt-1 text-sm text-red-600">{{ errors.txn_date }}</p>
          {% endif %}
        </div>

        <div>
          <label class="text-sm font-medium" for="amount">金額（円）</label>
          <input
            id="amount"
            type="number"
            inputmode="numeric"
            min="0"
            step="1"
            name="amount"
            placeholder="例）1500"
            value="{{ form.amount if form.amount is defined else '' }}"
            class="mt-2 w-full rounded-xl border px-3 py-2"
          />
          {% if errors.amount %}
            <p class="mt-1 text-sm text-red-600">{{ errors.amount }}</p>
          {% endif %}
        </div>
      </div>

      <div>
        <label class="text-sm font-medium" for="memo">メモ</label>
        <textarea
          id="memo"
          name="memo"
          rows="3"
          class="mt-2 w-full rounded-xl border px-3 py-2"
          placeholder="任意"
        >{{ form.memo if form.memo is defined else '' }}</textarea>
      </div>

      <div class="flex gap-3">
        <button
          type="submit"
          class="inline-flex items-center rounded-xl bg-blue-600 px-4 py-2 text-white font-medium hover:bg-blue-700"
        >
          登録
        </button>
        <a
          href="{{ url_for('index') }}"
          class="inline-flex items-center rounded-xl bg-white px-4 py-2 font-medium text-gray-800 border hover:bg-gray-50"
        >
          戻る
        </a>
      </div>
    </form>
  </section>
{% endblock %}
